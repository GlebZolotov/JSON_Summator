# JSON_Summator
Handler of JSON for Apache Kafka

Инструкции по запуску приложения:
./main -b <brokers> -i <input_topic_name> -o <output_topic_name> -g <group_id> -n <number_of_workers> -s <size_of_ring_buffers> -t <size_of_batch> -l <limit_count> -c <path_to_csv>
  
  brokers - ip-адреса(с портами) брокеров Kafka
  input_topic_name - название входящего топика
  output_topic_name - название исходящего топика
  group_id - название группы
  numbers_of_workers - количество потоков-воркеров
  size_of_ring_buffers - размер кольцевых буферов
  size_of_batch - максимальный размер вычитываемого из Kafka батча
  limit_count - количество сообщений в буфере, при котором будет произведена попытка чтения новых сообщений из Kafka с целью наполнения буфера
  path_to_csv - путь до csv-файла на диске (этот функционал не реализован до конца из-за недавнего уточнения о количествах и содержимом файлов)
  
Например (примеры запуска можно увидеть в TestSrc/kafka_run.sh):
  ./main -b localhost:9092 -i input_topic -o output_topic -g test1 -n 4-s 100 -t 20 -l 50 -c ../TestSrc/csv/data0.csv
  - запустит приложение с 4 воркерами, читающее input_topic локального брокера Kafka (с Consumer в группе test1) не более 20 сообщений в batch'е, с кольцевым буфером размера 100, который будет пополняться, когда в нём будет меньше 50 сообщений.
  
САМОЕ ИНТЕРЕСНОЕ: в случае двух очередей надо передать дополнительные параметры -i -o -g, например для двух очередей будет так:
  ./main -b localhost:9092 -i input_topic1 -i input_topic2 -o output_topic1 -o output_topic2 -g test1 -g test2 -n 4 -s 100 -t 20 -l 50 -c ../TestSrc/csv/data0.csv
  - в этом случае будет создано два Consumer (по одному на каждый входной топик и группу), который будут получать сообщения для двух разных кольцевых буферов (с одинаковыми параметрами -s и -l). Воркеры получают сообщения из обоих буферов, сначала проверяя, есть ли в данном буфере сообщения, если есть, то читают, если нет, то проверяют следующий буфер. Внутри все структуры объединяются в вектора, поэтому нет принципиальных ограничений на две входные очереди, можно использовать и больше.  

